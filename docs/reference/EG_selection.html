<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Selection of survey sites maximizing uniformity in environmental space
considering geographic structure — EG_selection • biosurvey</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Selection of survey sites maximizing uniformity in environmental space
considering geographic structure — EG_selection" />
<meta property="og:description" content="Selection of sites to be sampled in a survey, with the goal of
maximizing uniformity of points in the environment, but considering
geographic patterns of data. Sets of points that are environmentally similar
and have a disjoint pattern in geography, are selected twice (two survey
sites are placed so they consider the biggest geographic clusters)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">biosurvey</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/biosurvey_preparing_data.html">biosurvey: Preparing data</a>
    </li>
    <li>
      <a href="../articles/biosurvey_selecting_sites.html">biosurvey: Selecting sampling sites</a>
    </li>
    <li>
      <a href="../articles/biosurvey_selection_with_preselected_sites.html">biosurvey: Selecting sampling sites using preselected points</a>
    </li>
    <li>
      <a href="../articles/biosurvey_testing_module.html">biosurvey: Testing efficiency of selected sites</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/claununez/biosurvey/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Selection of survey sites maximizing uniformity in environmental space
considering geographic structure</h1>
    <small class="dont-index">Source: <a href='https://github.com/claununez/biosurvey/blob/master/R/EG_selection.R'><code>R/EG_selection.R</code></a></small>
    <div class="hidden name"><code>EG_selection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Selection of sites to be sampled in a survey, with the goal of
maximizing uniformity of points in the environment, but considering
geographic patterns of data. Sets of points that are environmentally similar
and have a disjoint pattern in geography, are selected twice (two survey
sites are placed so they consider the biggest geographic clusters).</p>
    </div>

    <pre class="usage"><span class='fu'>EG_selection</span><span class='op'>(</span><span class='va'>master</span>, <span class='va'>n_blocks</span>, guess_distances <span class='op'>=</span> <span class='cn'>TRUE</span>, initial_distance <span class='op'>=</span> <span class='cn'>NULL</span>,
             increase <span class='op'>=</span> <span class='cn'>NULL</span>, max_n_samplings <span class='op'>=</span> <span class='fl'>1</span>, replicates <span class='op'>=</span> <span class='fl'>10</span>,
             use_preselected_sites <span class='op'>=</span> <span class='cn'>TRUE</span>, select_point <span class='op'>=</span> <span class='st'>"E_centroid"</span>,
             cluster_method <span class='op'>=</span> <span class='st'>"hierarchical"</span>, median_distance_filter <span class='op'>=</span> <span class='cn'>NULL</span>,
             sample_for_distance <span class='op'>=</span> <span class='fl'>250</span>, set_seed <span class='op'>=</span> <span class='fl'>1</span>,
             verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, force <span class='op'>=</span> <span class='cn'>FALSE</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>master</th>
      <td><p>master_matrix object derived from the function
<code><a href='prepare_master_matrix.html'>prepare_master_matrix</a></code> or master_selection object derived from
functions <code><a href='random_selection.html'>random_selection</a></code>, <code><a href='uniformG_selection.html'>uniformG_selection</a></code>,
or <code><a href='uniformE_selection.html'>uniformE_selection</a></code>.</p></td>
    </tr>
    <tr>
      <th>n_blocks</th>
      <td><p>(numeric) number of blocks to be selected to be used as the
base for further explorations. Default = NULL.</p></td>
    </tr>
    <tr>
      <th>guess_distances</th>
      <td><p>(logical) whether or not to use internal algorithm
to automatically select <code>initial_distance</code> and <code>increase</code>. Default
= TRUE. If FALSE, <code>initial_distance</code> and <code>increase</code> must be
defined.</p></td>
    </tr>
    <tr>
      <th>initial_distance</th>
      <td><p>(numeric) Euclidean distance to be used for a first
process of thinning and detection of remaining blocks. See details in
<code><a href='point_thinning.html'>point_thinning</a></code>. Default = NULL.</p></td>
    </tr>
    <tr>
      <th>increase</th>
      <td><p>(numeric) initial value to be added to or subtracted from
<code>initial_distance</code> until reaching the number of <code>expected_points</code>.
Default = NULL.</p></td>
    </tr>
    <tr>
      <th>max_n_samplings</th>
      <td><p>(numeric) maximum number of samples to be chosen
after performing all thinning <code>replicates</code>. Default = 1.</p></td>
    </tr>
    <tr>
      <th>replicates</th>
      <td><p>(numeric) number of thinning replicates performed to
select blocks uniformly. Default = 10.</p></td>
    </tr>
    <tr>
      <th>use_preselected_sites</th>
      <td><p>(logical) whether to use sites that have been
defined as part of the selected sites previous any selection. Object in
<code>master</code> must contain the site(s) preselected in and element of name
"preselected_sites" for this argument to be effective. Default = TRUE.
See details for more information on the approach used.</p></td>
    </tr>
    <tr>
      <th>select_point</th>
      <td><p>(character) how or which point will be selected for each
block or cluster. Three options are available: "random", "E_centroid", and
"G_centroid". E_ or G_ centroid indicate that the point(s) closets to the
respective centroid will be selected. Default = "E_centroid".</p></td>
    </tr>
    <tr>
      <th>cluster_method</th>
      <td><p>(character) name of the method to be used for detecting
geographic clusters of points inside each block. Options are "hierarchical"
and "k-means"; default = "hierarchical". See details in
<code><a href='find_clusters.html'>find_clusters</a></code>.</p></td>
    </tr>
    <tr>
      <th>median_distance_filter</th>
      <td><p>(character) optional argument to define a
median distance-based filter based on which sets of sampling sites will be
selected. The default, NULL, does not apply such a filter. Options are:
"max" and "min". See details.</p></td>
    </tr>
    <tr>
      <th>sample_for_distance</th>
      <td><p>(numeric) sample to be considered when measuring
the geographic distances among points in blocks created in environmental
space. The distances measured are then used to test whether points are
distributed uniformly or not in the geography. Default = 250.</p></td>
    </tr>
    <tr>
      <th>set_seed</th>
      <td><p>(numeric) integer value to specify a initial seed.
Default = 1.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>(logical) whether or not to print messages about the process.
Default = TRUE.</p></td>
    </tr>
    <tr>
      <th>force</th>
      <td><p>(logical) whether to replace existing set of sites selected
with this method in <code>master</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A <code><a href='master_selection.html'>master_selection</a></code> object (S3) with a special element called
selected_sites_EG containing one or more sets of selected sites depending on
<code>max_n_samplings</code> and <code>median_distance_filter</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Two important steps are needed before using this function: 1) exploring data
in environmental and geographic spaces, and 2) performing a regionalization
of the environmental space. Exploring the data can be done using the function
<code><a href='explore_data_EG.html'>explore_data_EG</a></code>. This step is optional but strongly
recommended, as important decisions that need to be taken depend on the
of the data in the two spaces. A regionalization of the environmental space
configuration of the region of interest helps in defining important parts of
your region that should be considered to select sites. This can be done
using the function <code><a href='make_blocks.html'>make_blocks</a></code>. Later, the regions created in
environmental space will be used for selecting one or more sampling sites per
block depending on the geographic pattern of such environmental combinations.</p>
<p>The process of survey-site selection with this function is the most complex
among all functions in this package. The complexity derives from the aim of
the function, which is to select sites that sample appropriately
environmental combinations in the region of interest (environmental space),
but considering the geographic patterns of such environmental regions
(geographic space).</p>
<p>In this approach, the first step is to select candidate blocks (from the
ones obtained with <code><a href='make_blocks.html'>make_blocks</a></code>) that are uniformly distributed
in environmental space. The geographic configuration of points in such
blocks is explored to detect whether they are clustered (i.e., similar
environmental conditions are present in distant places in the region of
interest). For blocks with points that present one cluster in geography,
only one survey site is selected, and for those with multiple clusters in
geographic space, two survey sites are selected considering the two largest
clusters.</p>
<p>If <code>use_preselected_sites</code> is TRUE and such sites are included as an
element in the object in <code>master</code>, the approach for selecting sites in
environmental space considering geographic patterns is a little  different.
User-preselected sites will always be part of the sites selected. Other points
are selected based on an algorithm that searches for sites that are uniformly
distributed in environmental space but at a distance from preselected sites
that helps in maintaining uniformity among environmental blocks selected.
Note that preselected sites will not be processed, therefore, uniformity of
blocks representing such points cannot be warrantied.</p>
<p>As multiple sets could result from selection, the argument of the function
<code>median_distance_filter</code> could be used to select the set of sites with
the maximum ("max") or minimum ("min") median distance among selected sites.
Option "max" will increase the geographic distance among sampling sites,
which could be desirable if the goal is to cover the region of interest more
broadly. The other option, "min", could be used in cases when the goal is to
reduce resources and time needed to sample such sites.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='uniformG_selection.html'>uniformG_selection</a></code>, <code><a href='uniformE_selection.html'>uniformE_selection</a></code>,
<code><a href='random_selection.html'>random_selection</a></code>, <code><a href='make_blocks.html'>make_blocks</a></code>,
<code><a href='plot_sites_EG.html'>plot_sites_EG</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># Data</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>"m_matrix"</span>, package <span class='op'>=</span> <span class='st'>"biosurvey"</span><span class='op'>)</span>

<span class='co'># Making blocks for analysis</span>
<span class='va'>m_blocks</span> <span class='op'>&lt;-</span> <span class='fu'><a href='make_blocks.html'>make_blocks</a></span><span class='op'>(</span><span class='va'>m_matrix</span>, variable_1 <span class='op'>=</span> <span class='st'>"PC1"</span>, variable_2 <span class='op'>=</span> <span class='st'>"PC2"</span>,
                        n_cols <span class='op'>=</span> <span class='fl'>10</span>, n_rows <span class='op'>=</span> <span class='fl'>10</span>, block_type <span class='op'>=</span> <span class='st'>"equal_area"</span><span class='op'>)</span>

<span class='co'># Checking column names</span>
<span class='fu'><a href='https://rdrr.io/r/base/colnames.html'>colnames</a></span><span class='op'>(</span><span class='va'>m_blocks</span><span class='op'>$</span><span class='va'>data_matrix</span><span class='op'>)</span>
</div><div class='output co'>#&gt;  [1] "Longitude"            "Latitude"             "Mean_temperature"    
#&gt;  [4] "Max_temperature"      "Min_temperature"      "Annual_precipitation"
#&gt;  [7] "Prec_wettest_month"   "Prec_driest_month"    "PC1"                 
#&gt; [10] "PC2"                  "Block"               </div><div class='input'>
<span class='co'># Selecting sites uniformly in E and G spaces</span>
<span class='va'>EG_sel</span> <span class='op'>&lt;-</span> <span class='fu'>EG_selection</span><span class='op'>(</span>master <span class='op'>=</span> <span class='va'>m_blocks</span>, n_blocks <span class='op'>=</span> <span class='fl'>10</span>,
                       initial_distance <span class='op'>=</span> <span class='fl'>1.5</span>, increase <span class='op'>=</span> <span class='fl'>0.1</span>,
                       replicates <span class='op'>=</span> <span class='fl'>1</span>, max_n_samplings <span class='op'>=</span> <span class='fl'>1</span>,
                       select_point <span class='op'>=</span> <span class='st'>"E_centroid"</span>,
                       cluster_method <span class='op'>=</span> <span class='st'>"hierarchical"</span>,
                       sample_for_distance <span class='op'>=</span> <span class='fl'>100</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Element 'preselected_sites' in 'master' is NULL, setting</span>
#&gt; <span class='message'>'use_preselected_sites' = FALSE</span></div><div class='output co'>#&gt; <span class='message'>Preparing data for analysis</span></div><div class='output co'>#&gt; <span class='message'>Selecting relevant environmental blocks, please wait...</span></div><div class='output co'>#&gt; <span class='message'>Running algorithm for selecting sites, please wait...</span></div><div class='output co'>#&gt; <span class='message'>    Process 1 of 1</span></div><div class='output co'>#&gt; <span class='message'>Total number of sites selected: 14</span></div><div class='input'>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>EG_sel</span><span class='op'>$</span><span class='va'>selected_sites_EG</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt;       Longitude Latitude Mean_temperature Max_temperature Min_temperature
#&gt; 5038  -98.58333 19.08333               96             194              -6
#&gt; 5046  -97.25000 19.08333               85             180              -6
#&gt; 6073  -92.25000 16.58333              147             231              59
#&gt; 2128 -107.75000 26.58333              171             308              27
#&gt; 5856  -92.91667 17.25000              193             273             107
#&gt; 5652  -96.25000 17.75000              236             327             149
#&gt;      Annual_precipitation Prec_wettest_month Prec_driest_month        PC1
#&gt; 5038                 1089                207                 9 -1.7182406
#&gt; 5046                 1560                299                30 -0.4882353
#&gt; 6073                 1261                214                29  0.1872086
#&gt; 2128                 1113                299                12  0.1343308
#&gt; 5856                 2440                356                75  4.0757658
#&gt; 5652                 3750                738                72  7.6112110
#&gt;            PC2 Block
#&gt; 5038 -4.646724     2
#&gt; 5046 -5.901798    23
#&gt; 6073 -3.435252    36
#&gt; 2128 -1.586154    38
#&gt; 5856 -3.565550    69
#&gt; 5652 -3.410408   102</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/dim.html'>dim</a></span><span class='op'>(</span><span class='va'>EG_sel</span><span class='op'>$</span><span class='va'>selected_sites_EG</span><span class='op'>[[</span><span class='fl'>1</span><span class='op'>]</span><span class='op'>]</span><span class='op'>)</span>
</div><div class='output co'>#&gt; [1] 14 11</div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Claudia Nuñez-Penichet, Marlon E. Cobos, Jorge Soberón, Tomer Gueta, Narayani Barve, Vijay Barve, Adolfo G. Navarro-Sigüenza, A. Townsend Peterson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


